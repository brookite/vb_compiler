# Visual Basic Compiler

*Курсовая работа по трансляции языков*
Компилятор языка Visual Basic в байткод виртуальной машины JVM, покрывающий часть его функционала

## Возможности

- Литералы строк, целых и вещественных чисел
- Переменные и константы внутри функции
- Операции с примитивными типами
- Строки (а также получение символов из них, конкатенация, преобразование в числа)
- Поддержка дат и времени
- Классы с поддержкой одиночного наследования
- Поля классов
- Процедуры и функции (методы)
- Развилки и циклы
- Одномерные массивы (с возможностью получения их размера)
- Очистка и расширение массива (`Erase`, `Redim`, `Redim Preserve`)
- Шаблонизация классов
- RTL для работы с консолью, математическими функциями
- Статические процедуры и функции, поля
- Проверка типов, нарушения семантики языка перед компиляцией
- Сборка программы в jar-архив для запуска

### Не поддерживается

- Развилки `Select`
- Перегрузка функций по типу параметров
- StackMap атрибут в байткоде. Поэтому приложения нужно запускать с ключом `-noverify`

## Системные требования

- Для запуска:
  - Windows 10 и выше
  - Установленная JVM версии 21 для запуска скомпилированной программы
  - *Опционально:* JDK версии 21 для сборки скомпилированной программы в jar-архив, прописанная в переменную PATH (для доступа к утилите `jar`)
- Для сборки также потребуется:
  - MSVC 2022 компилятор (Visual Studio 2022)
  - Прописанный путь к папке `winflexbison` в корне репозитория в `PATH` переменную
  - Graphviz в `PATH` для запуска тестов синтаксического анализатора

## Запуск

### Компиляция

```bash
> VBCompiler.exe path_to_vb_file.vb [--debug]
```

Для запуска тестов парсера:

```bash
> VBCompiler.exe --test-parser 
```

Для запуска тестов компиляции:

```bash
> VBCompiler.exe --test
```

### Запуск скомпилированного приложения

Если поддерживается сборка в jar:

```bash
> java -noverify -jar out/path_to_vb_file.vb.jar
```

Или конкретно по имени вашего главного класса
Пример:

```bash
> java -cp out/path_to_vb_file out/path_to_vb_file/brookit/vb/code/main.class
```
